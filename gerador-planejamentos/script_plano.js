document.addEventListener('DOMContentLoaded', function() {
    // Verificar se o usuário está logado
    if (!localStorage.getItem('loggedIn')) {
        window.location.href = 'login.html';
        return;
    }

    // Contadores globais
    let contadorHabilidades = 0;
    let contadorCriterios = 0;
    let contadorInstrumentos = 0;
    let contadorAulas = 0;

    // Função para redimensionar textarea automaticamente
    function autoResizeTextarea(textarea) {
        if (textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        } else {
            console.error('Textarea não encontrado para redimensionamento.');
        }
    }

    // Função para formatar data no formato dd/mm/aaaa
    function formatarData(data) {
        if (!data) return 'Sem Data';
        const [ano, mes, dia] = data.split('-');
        return `${dia}/${mes}/${ano}`;
    }

    // Função para formatar data e hora no formato dd/mm/aaaa hh:mm:ss
    function formatarDataHora(timestamp) {
        const date = new Date(timestamp);
        const dia = String(date.getDate()).padStart(2, '0');
        const mes = String(date.getMonth() + 1).padStart(2, '0');
        const ano = date.getFullYear();
        const horas = String(date.getHours()).padStart(2, '0');
        const minutos = String(date.getMinutes()).padStart(2, '0');
        const segundos = String(date.getSeconds()).padStart(2, '0');
        return `${dia}/${mes}/${ano} ${horas}:${minutos}:${segundos}`;
    }

    // Função para adicionar cabeçalho em todas as páginas do PDF
    function adicionarCabecalho(doc, vigenciaDe, vigenciaAte, isPrimeiraPagina) {
        const logoSCBase64 = 'data:image/png;base64,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';
        const logoGovBase64 = 'data:image/png;base64,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';
        const logoWidth = 15;
        const logoHeight = 15;

        try {
            doc.addImage(logoSCBase64, 'PNG', 15, 11, logoWidth, logoHeight);
            doc.addImage(logoGovBase64, 'PNG', 268, 11, logoWidth, logoHeight);
        } catch (e) {
            console.warn('Erro ao adicionar logos:', e);
        }

        doc.setFontSize(12);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(0, 0, 0);
        doc.text('ESTADO DE SANTA CATARINA', 35, 15);
        doc.text('SECRETARIA DE ESTADO DA EDUCAÇÃO', 35, 20);
        doc.text('COORDENADORIA REGIONAL DE EDUCAÇÃO DE MAFRA', 35, 25);
    }

    // Função para adicionar campo de habilidade
    window.adicionarSelect = function(valor = '') {
        contadorHabilidades++;
        const container = document.getElementById('containerSelect');
        if (!container) {
            console.error('Container de habilidades (containerSelect) não encontrado!');
            return;
        }

        let habilidades = JSON.parse(localStorage.getItem('habilidades')) || [];
        if (habilidades.length === 0) {
            console.warn('Nenhuma habilidade encontrada no localStorage. Adicionando lista padrão.');
            habilidades = ['Habilidade 1', 'Habilidade 2', 'Habilidade 3'];
            localStorage.setItem('habilidades', JSON.stringify(habilidades));
        }
        habilidades.sort((a, b) => a.localeCompare(b));

        const div = document.createElement('div');
        div.className = 'form-group-select';
        div.id = `habilidadeGroup${contadorHabilidades}`;
        div.innerHTML = `
            <select id="habilidade${contadorHabilidades}" name="habilidade${contadorHabilidades}">
                <option value="">Selecione uma habilidade</option>
            </select>
            <button type="button" onclick="removerCampoEspecifico(${contadorHabilidades}, 'habilidade')" class="btn-remove">X</button>
        `;
        container.appendChild(div);

        const select = document.getElementById(`habilidade${contadorHabilidades}`);
        if (!select) {
            console.error(`Select habilidade${contadorHabilidades} não criado corretamente!`);
            return;
        }

        habilidades.forEach(habilidade => {
            const option = document.createElement('option');
            option.value = habilidade;
            option.text = habilidade;
            select.appendChild(option);
        });

        if (valor) select.value = valor;
    };

    // Função para adicionar campo de critério
    window.adicionarCriterioSelect = function(valor = '') {
        contadorCriterios++;
        const container = document.getElementById('criteriosAvaliacaoContainer');
        if (!container) {
            console.error('Container de critérios (criteriosAvaliacaoContainer) não encontrado!');
            return;
        }

        let criterios = JSON.parse(localStorage.getItem('criteriosAvaliacao')) || [];
        if (criterios.length === 0) {
            console.warn('Nenhum critério encontrado no localStorage. Adicionando lista padrão.');
            criterios = ['Critério 1', 'Critério 2', 'Critério 3'];
            localStorage.setItem('criteriosAvaliacao', JSON.stringify(criterios));
        }
        criterios.sort((a, b) => a.localeCompare(b));

        const div = document.createElement('div');
        div.className = 'form-group-select';
        div.id = `criterioGroup${contadorCriterios}`;
        div.innerHTML = `
            <select id="criterio${contadorCriterios}" name="criterio${contadorCriterios}">
                <option value="">Selecione um critério</option>
            </select>
            <button type="button" onclick="removerCampoEspecifico(${contadorCriterios}, 'criterio')" class="btn-remove">X</button>
        `;
        container.appendChild(div);

        const select = document.getElementById(`criterio${contadorCriterios}`);
        if (!select) {
            console.error(`Select criterio${contadorCriterios} não criado corretamente!`);
            return;
        }

        criterios.forEach(criterio => {
            const option = document.createElement('option');
            option.value = criterio;
            option.text = criterio;
            select.appendChild(option);
        });

        if (valor) select.value = valor;
    };

    // Função para adicionar campo de instrumento
    window.adicionarInstrumentoSelect = function(valor = '') {
        contadorInstrumentos++;
        const container = document.getElementById('instrumentosAvaliacaoContainer');
        if (!container) {
            console.error('Container de instrumentos (instrumentosAvaliacaoContainer) não encontrado!');
            return;
        }

        let instrumentos = JSON.parse(localStorage.getItem('instrumentosAvaliacao')) || [];
        if (instrumentos.length === 0) {
            console.warn('Nenhum instrumento encontrado no localStorage. Adicionando lista padrão.');
            instrumentos = ['Instrumento 1', 'Instrumento 2', 'Instrumento 3'];
            localStorage.setItem('instrumentosAvaliacao', JSON.stringify(instrumentos));
        }
        instrumentos.sort((a, b) => a.localeCompare(b));

        const div = document.createElement('div');
        div.className = 'form-group-select';
        div.id = `instrumentoGroup${contadorInstrumentos}`;
        div.innerHTML = `
            <select id="instrumento${contadorInstrumentos}" name="instrumento${contadorInstrumentos}">
                <option value="">Selecione um instrumento</option>
            </select>
            <button type="button" onclick="removerCampoEspecifico(${contadorInstrumentos}, 'instrumento')" class="btn-remove">X</button>
        `;
        container.appendChild(div);

        const select = document.getElementById(`instrumento${contadorInstrumentos}`);
        if (!select) {
            console.error(`Select instrumento${contadorInstrumentos} não criado corretamente!`);
            return;
        }

        instrumentos.forEach(instrumento => {
            const option = document.createElement('option');
            option.value = instrumento;
            option.text = instrumento;
            select.appendChild(option);
        });

        if (valor) select.value = valor;
    };

    // Função para adicionar campo de aula
    window.adicionarAulaField = function(valor = '') {
        contadorAulas++;
        const container = document.getElementById('aulaFieldsContainer');
        if (!container) {
            console.error('Container de aulas (aulaFieldsContainer) não encontrado!');
            return;
        }

        const div = document.createElement('div');
        div.className = 'form-group';
        div.id = `aulaGroup${contadorAulas}`;
        div.innerHTML = `
            <textarea id="aula${contadorAulas}" name="aula${contadorAulas}" class="auto-resize" rows="4" cols="50" placeholder="Descreva sua aula">${valor}</textarea>
            <button type="button" onclick="removerCampoEspecifico(${contadorAulas}, 'aula')" class="btn-remove">X</button>
        `;
        container.appendChild(div);

        const textarea = document.getElementById(`aula${contadorAulas}`);
        if (!textarea) {
            console.error(`Textarea aula${contadorAulas} não criado corretamente!`);
            return;
        }

        autoResizeTextarea(textarea);
        textarea.addEventListener('input', function() {
            autoResizeTextarea(this);
        });
    };

    // Função para remover campo específico
    window.removerCampoEspecifico = function(id, tipo) {
        const prefix = tipo === 'habilidade' ? 'habilidadeGroup' :
                      tipo === 'criterio' ? 'criterioGroup' :
                      tipo === 'instrumento' ? 'instrumentoGroup' : 'aulaGroup';
        const campo = document.getElementById(`${prefix}${id}`);
        if (campo) {
            campo.remove();
            if (tipo === 'habilidade') renumerarCampos('habilidade', 'containerSelect', contadorHabilidades);
            else if (tipo === 'criterio') renumerarCampos('criterio', 'criteriosAvaliacaoContainer', contadorCriterios);
            else if (tipo === 'instrumento') renumerarCampos('instrumento', 'instrumentosAvaliacaoContainer', contadorInstrumentos);
            else if (tipo === 'aula') renumerarCampos('aula', 'aulaFieldsContainer', contadorAulas);
        } else {
            console.error(`Campo ${prefix}${id} não encontrado para remoção!`);
        }
    };

    // Função para renumerar campos
    function renumerarCampos(tipo, containerId, contador) {
        const grupos = document.querySelectorAll(`#${containerId} .form-group-select, #${containerId} .form-group`);
        const prefix = tipo === 'habilidade' ? 'habilidade' :
                      tipo === 'criterio' ? 'criterio' :
                      tipo === 'instrumento' ? 'instrumento' : 'aula';
        if (tipo === 'habilidade') contadorHabilidades = 0;
        else if (tipo === 'criterio') contadorCriterios = 0;
        else if (tipo === 'instrumento') contadorInstrumentos = 0;
        else if (tipo === 'aula') contadorAulas = 0;

        grupos.forEach((grupo, index) => {
            const novoId = index + 1;
            if (tipo === 'habilidade') contadorHabilidades = novoId;
            else if (tipo === 'criterio') contadorCriterios = novoId;
            else if (tipo === 'instrumento') contadorInstrumentos = novoId;
            else if (tipo === 'aula') contadorAulas = novoId;

            const input = grupo.querySelector(tipo === 'aula' ? 'textarea' : 'select');
            const btnRemove = grupo.querySelector('.btn-remove');

            if (input) {
                input.id = `${prefix}${novoId}`;
                input.name = `${prefix}${novoId}`;
            } else {
                console.error(`Input ${prefix}${novoId} não encontrado em renumerarCampos!`);
            }

            if (btnRemove) {
                btnRemove.setAttribute('onclick', `removerCampoEspecifico(${novoId}, '${tipo}')`);
            }
            grupo.id = `${prefix}Group${novoId}`;
        });
    }

    // Funções para remover todos os campos
    window.removerTodosSelects = function() {
        const container = document.getElementById('containerSelect');
        if (!container || container.children.length === 0) {
            alert('Nenhuma habilidade para remover!');
            return;
        }
        container.innerHTML = '';
        contadorHabilidades = 0;
    };

    window.removerTodosCriterios = function() {
        const container = document.getElementById('criteriosAvaliacaoContainer');
        if (!container || container.children.length === 0) {
            alert('Nenhum critério para remover!');
            return;
        }
        container.innerHTML = '';
        contadorCriterios = 0;
    };

    window.removerTodosInstrumentos = function() {
        const container = document.getElementById('instrumentosAvaliacaoContainer');
        if (!container || container.children.length === 0) {
            alert('Nenhum instrumento para remover!');
            return;
        }
        container.innerHTML = '';
        contadorInstrumentos = 0;
    };

    window.removerTodasAulas = function() {
        const container = document.getElementById('aulaFieldsContainer');
        if (!container || container.children.length === 0) {
            alert('Nenhuma aula para remover!');
            return;
        }
        container.innerHTML = '';
        contadorAulas = 0;
    };

    // Função para carregar opções
    function loadOptions() {
        const nomeProfessorSelect = document.getElementById('nomeProfessorPlano');
        const escolaPlanoSelect = document.getElementById('escolaPlano');
        const componenteCurricularSelect = document.getElementById('componenteCurricularPlano');

        if (!nomeProfessorSelect || !escolaPlanoSelect || !componenteCurricularSelect) {
            console.error('Um ou mais selects (nomeProfessorPlano, escolaPlano, componenteCurricularPlano) não encontrados!');
            return;
        }

        // Limpar opções existentes
        Array.from(nomeProfessorSelect.options).forEach((option, index) => {
            if (index > 0) option.remove();
        });
        Array.from(escolaPlanoSelect.options).forEach((option, index) => {
            if (index > 0) option.remove();
        });
        Array.from(componenteCurricularSelect.options).forEach((option, index) => {
            if (index > 0) option.remove();
        });

        // Obter o currentUser (login) e mapear para o nome do professor
        const currentUser = localStorage.getItem('currentUser') || 'anonymous';
        const professorLogins = JSON.parse(localStorage.getItem('professorLogins')) || {};
        const nomeProfessor = professorLogins[currentUser] || currentUser; // Usa o login como fallback

        // Verificar se o usuário é um professor cadastrado
        const professores = JSON.parse(localStorage.getItem('professores')) || [];
        if (!professores.includes(nomeProfessor) && currentUser !== 'anonymous') {
            alert('Usuário não cadastrado como professor!');
            window.location.href = 'login.html';
            return;
        }

        // Preencher campo Professor com nomeProfessor e desabilitar
        const optionProfessor = document.createElement('option');
        optionProfessor.value = nomeProfessor;
        optionProfessor.text = nomeProfessor;
        nomeProfessorSelect.appendChild(optionProfessor);
        nomeProfessorSelect.value = nomeProfessor;
        nomeProfessorSelect.disabled = true;

        // Carregar escolas
        let escolas = JSON.parse(localStorage.getItem('escolas')) || [];
        if (escolas.length === 0) {
            console.warn('Nenhuma escola encontrada no localStorage. Adicionando lista padrão.');
            escolas = ['Escola X', 'Escola Y'];
            localStorage.setItem('escolas', JSON.stringify(escolas));
        }
        escolas.forEach(escola => {
            const option = document.createElement('option');
            option.value = escola;
            option.text = escola;
            escolaPlanoSelect.appendChild(option);
        });

        // Carregar componentes curriculares associados ao nomeProfessor
        let professoresComponentes = JSON.parse(localStorage.getItem('professoresComponentes')) || {};
        let componentesCurriculares = professoresComponentes[nomeProfessor] || [];
        if (componentesCurriculares.length === 0) {
            console.warn(`Nenhum componente curricular associado ao professor ${nomeProfessor}. Adicionando lista padrão.`);
            componentesCurriculares = ['Física', 'Matemática', 'Português'];
            professoresComponentes[nomeProfessor] = componentesCurriculares;
            localStorage.setItem('professoresComponentes', JSON.stringify(professoresComponentes));
        }
        componentesCurriculares.forEach(componente => {
            const option = document.createElement('option');
            option.value = componente;
            option.text = componente;
            componenteCurricularSelect.appendChild(option);
        });
    }

    // Função para salvar o plano
    window.salvarPlano = function() {
        // Obter o currentUser (login) e mapear para o nome do professor
        const currentUser = localStorage.getItem('currentUser') || 'anonymous';
        const professorLogins = JSON.parse(localStorage.getItem('professorLogins')) || {};
        const nomeProfessor = professorLogins[currentUser] || currentUser;

        const vigenciaDe = document.getElementById('vigenciaDe')?.value || '';
        const vigenciaAte = document.getElementById('vigenciaAte')?.value || '';
        const escola = document.getElementById('escolaPlano')?.value || '';
        const componenteCurricular = document.getElementById('componenteCurricularPlano')?.value || '';
        const serieTurma = document.getElementById('serieTurma')?.value || '';
        const objetosConhecimento = document.getElementById('objetosConhecimento')?.value || '';
        const referenciasBibliograficas = document.getElementById('referenciasBibliograficas')?.value || '';

        const habilidadesSelects = document.querySelectorAll('select[name^="habilidade"]');
        const habilidades = Array.from(habilidadesSelects)
            .map(select => select.value.trim())
            .filter(valor => valor);

        const criteriosSelects = document.querySelectorAll('select[name^="criterio"]');
        const criteriosAvaliacao = Array.from(criteriosSelects)
            .map(select => select.value.trim())
            .filter(valor => valor);

        const instrumentosSelects = document.querySelectorAll('select[name^="instrumento"]');
        const instrumentosAvaliacao = Array.from(instrumentosSelects)
            .map(select => select.value.trim())
            .filter(valor => valor);

        const aulasTextareas = document.querySelectorAll('textarea[name^="aula"]');
        const aulas = Array.from(aulasTextareas)
            .map((textarea, index) => textarea.value.trim() || `Aula ${index + 1} não preenchida`);

        const nomeProfessorPlano = document.getElementById('nomeProfessorPlano')?.value || '';
        if (nomeProfessorPlano !== nomeProfessor) {
            alert('O professor selecionado não corresponde ao usuário logado!');
            return;
        }

        const timestamp = Date.now();
        const plano = {
            id: `${currentUser}_${nomeProfessor.replace(/ /g, '_')}_${serieTurma.replace(/ /g, '_')}_${vigenciaDe}_${timestamp}`,
            nomePlano: `${nomeProfessor || 'Sem Professor'} - ${escola || 'Sem Escola'} - ${componenteCurricular || 'Sem Componente'} - ${serieTurma || 'Sem Turma'} - ${formatarDataHora(timestamp)}`,
            vigenciaDe,
            vigenciaAte,
            escola,
            nomeProfessor,
            componenteCurricular,
            serieTurma,
            objetosConhecimento,
            habilidades,
            criteriosAvaliacao,
            instrumentosAvaliacao,
            aulas,
            referenciasBibliograficas,
            user: currentUser
        };

        let planosSalvos = JSON.parse(localStorage.getItem('planosSalvos')) || [];
        const index = planosSalvos.findIndex(p => p.id === plano.id);
        if (index !== -1) {
            planosSalvos[index] = plano; // Atualiza plano existente
        } else {
            planosSalvos.push(plano); // Adiciona novo plano
        }
        localStorage.setItem('planosSalvos', JSON.stringify(planosSalvos));

        alert('Plano salvo com sucesso!');
        loadPlanosSalvos();
    };

    // Função para carregar planos salvos no select
    function loadPlanosSalvos() {
        const planosSalvosSelect = document.getElementById('planosSalvos');
        if (!planosSalvosSelect) {
            console.error('Select de planos salvos (planosSalvos) não encontrado!');
            return;
        }

        Array.from(planosSalvosSelect.options).forEach((option, index) => {
            if (index > 0) option.remove();
        });

        const currentUser = localStorage.getItem('currentUser') || 'anonymous';
        const planosSalvos = JSON.parse(localStorage.getItem('planosSalvos')) || [];
        const userPlanos = planosSalvos.filter(plano => plano.user === currentUser);

        userPlanos.forEach(plano => {
            const option = document.createElement('option');
            option.value = plano.id;
            option.text = plano.nomePlano;
            planosSalvosSelect.appendChild(option);
        });
    }

    // Função para carregar um plano no formulário
    window.carregarPlano = function() {
        const planosSalvosSelect = document.getElementById('planosSalvos');
        if (!planosSalvosSelect) {
            console.error('Select de planos salvos (planosSalvos) não encontrado!');
            return;
        }

        const planoId = planosSalvosSelect.value;
        if (!planoId) {
            alert('Selecione um plano para carregar!');
            return;
        }

        const planosSalvos = JSON.parse(localStorage.getItem('planosSalvos')) || [];
        const plano = planosSalvos.find(p => p.id === planoId);
        if (!plano) {
            alert('Plano não encontrado!');
            return;
        }

        // Limpar campos existentes
        const containerSelect = document.getElementById('containerSelect');
        const criteriosContainer = document.getElementById('criteriosAvaliacaoContainer');
        const instrumentosContainer = document.getElementById('instrumentosAvaliacaoContainer');
        const aulasContainer = document.getElementById('aulaFieldsContainer');
        if (containerSelect) containerSelect.innerHTML = '';
        if (criteriosContainer) criteriosContainer.innerHTML = '';
        if (instrumentosContainer) instrumentosContainer.innerHTML = '';
        if (aulasContainer) aulasContainer.innerHTML = '';
        contadorHabilidades = 0;
        contadorCriterios = 0;
        contadorInstrumentos = 0;
        contadorAulas = 0;

        // Preencher campos fixos
        const vigenciaDe = document.getElementById('vigenciaDe');
        const vigenciaAte = document.getElementById('vigenciaAte');
        const escolaPlano = document.getElementById('escolaPlano');
        const nomeProfessorPlano = document.getElementById('nomeProfessorPlano');
        const componenteCurricularPlano = document.getElementById('componenteCurricularPlano');
        const serieTurma = document.getElementById('serieTurma');
        const objetosConhecimento = document.getElementById('objetosConhecimento');
        const referenciasBibliograficas = document.getElementById('referenciasBibliograficas');

        if (vigenciaDe) vigenciaDe.value = plano.vigenciaDe || '';
        if (vigenciaAte) vigenciaAte.value = plano.vigenciaAte || '';
        if (escolaPlano) escolaPlano.value = plano.escola || '';
        if (nomeProfessorPlano) nomeProfessorPlano.value = plano.nomeProfessor || '';
        if (componenteCurricularPlano) componenteCurricularPlano.value = plano.componenteCurricular || '';
        if (serieTurma) serieTurma.value = plano.serieTurma || '';
        if (objetosConhecimento) {
            objetosConhecimento.value = plano.objetosConhecimento || '';
            autoResizeTextarea(objetosConhecimento);
        }
        if (referenciasBibliograficas) {
            referenciasBibliograficas.value = plano.referenciasBibliograficas || '';
            autoResizeTextarea(referenciasBibliograficas);
        }

        // Preencher habilidades
        (plano.habilidades || []).forEach(habilidade => {
            window.adicionarSelect(habilidade);
        });

        // Preencher critérios
        (plano.criteriosAvaliacao || []).forEach(criterio => {
            window.adicionarCriterioSelect(criterio);
        });

        // Preencher instrumentos
        (plano.instrumentosAvaliacao || []).forEach(instrumento => {
            window.adicionarInstrumentoSelect(instrumento);
        });

        // Preencher aulas
        (plano.aulas || []).forEach(aula => {
            window.adicionarAulaField(aula);
        });

        alert('Plano carregado com sucesso!');
    };

    // Função para excluir um plano
    window.excluirPlano = function() {
        const planosSalvosSelect = document.getElementById('planosSalvos');
        if (!planosSalvosSelect) {
            console.error('Select de planos salvos (planosSalvos) não encontrado!');
            return;
        }

        const planoId = planosSalvosSelect.value;
        if (!planoId) {
            alert('Selecione um plano para excluir!');
            return;
        }

        if (!confirm('Tem certeza que deseja excluir este plano?')) {
            return;
        }

        let planosSalvos = JSON.parse(localStorage.getItem('planosSalvos')) || [];
        planosSalvos = planosSalvos.filter(plano => plano.id !== planoId);
        localStorage.setItem('planosSalvos', JSON.stringify(planosSalvos));

        alert('Plano excluído com sucesso!');
        loadPlanosSalvos();
        planosSalvosSelect.value = '';
    };

    // Função para gerar PDF
    const gerarPDFBtn = document.getElementById('gerarPDF');
    if (gerarPDFBtn) {
        gerarPDFBtn.addEventListener('click', function() {
            const { jsPDF } = window.jspdf;
            if (typeof jsPDF === 'undefined') {
                alert('jsPDF não carregado! Verifique as bibliotecas.');
                return;
            }
            const doc = new jsPDF({
                orientation: 'landscape',
                unit: 'mm',
                format: 'a4'
            });

            // Obter o currentUser (login) e mapear para o nome do professor
            const currentUser = localStorage.getItem('currentUser') || 'anonymous';
            const professorLogins = JSON.parse(localStorage.getItem('professorLogins')) || {};
            const nomeProfessor = professorLogins[currentUser] || currentUser;

            // Dados do formulário
            const vigenciaDe = document.getElementById('vigenciaDe')?.value || '';
            const vigenciaAte = document.getElementById('vigenciaAte')?.value || '';
            const escolaSelect = document.getElementById('escolaPlano');
            const escolas = escolaSelect ? escolaSelect.value : '';
            const componenteCurricular = document.getElementById('componenteCurricularPlano')?.value || '';
            const serieTurma = document.getElementById('serieTurma')?.value || '';
            const objetosConhecimento = document.getElementById('objetosConhecimento')?.value || '';

            const habilidadesSelects = document.querySelectorAll('select[name^="habilidade"]');
            const habilidades = Array.from(habilidadesSelects)
                .map(select => select.value.trim())
                .filter(valor => valor);

            const criteriosSelects = document.querySelectorAll('select[name^="criterio"]');
            const criteriosAvaliacao = Array.from(criteriosSelects)
                .map(select => select.value.trim())
                .filter(valor => valor);

            const instrumentosSelects = document.querySelectorAll('select[name^="instrumento"]');
            const instrumentosAvaliacao = Array.from(instrumentosSelects)
                .map(select => select.value.trim())
                .filter(valor => valor);

            const aulasTextareas = document.querySelectorAll('textarea[name^="aula"]');
            const aulaData = Array.from(aulasTextareas)
                .map((textarea, index) => [`Aula ${index + 1}`, textarea.value.trim() || `Aula ${index + 1} não preenchida`]);

            const referenciasBibliograficas = document.getElementById('referenciasBibliograficas')?.value || '';

            const startDate = vigenciaDe.replace(/-/g, '') || 'sem_data';
            const fileName = `planoDeAula_${startDate}_${(nomeProfessor || 'sem_professor').replace(/ /g, '_')}.pdf`.toLowerCase();

            const margemSuperiorPrimeira = 35;
            const margemSuperiorOutras = 35;
            const margemInferior = 20;

            let startY = margemSuperiorPrimeira + 25;

            doc.autoTable({
                startY: startY,
                margin: { top: margemSuperiorPrimeira, bottom: margemInferior },
                body: [['UNIDADE ESCOLAR:', escolas]],
                columnStyles: {
                    0: { cellWidth: 40, halign: 'left', fontStyle: 'bold' },
                    1: { cellWidth: '70%', halign: 'left', fontStyle: 'normal', fillColor: [255, 255, 255] }
                },
                theme: 'plain',
                styles: { 
                    fontSize: 10, 
                    cellPadding: 2, 
                    lineWidth: 0.1,
                    fillColor: [240, 240, 240]
                },
                didDrawPage: function(data) {
                    data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                    adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                }
            });
            startY = doc.autoTable.previous.finalY + 0;

            doc.autoTable({
                startY: startY,
                margin: { top: margemSuperiorPrimeira, bottom: margemInferior },
                body: [
                    ['NOME DO(A) PROFESSOR(A):', nomeProfessor, 'QUANTIDADE DE AULAS:', aulaData.length],
                    ['COMPONENTE CURRICULAR:', componenteCurricular, 'SÉRIE/TURMA:', serieTurma]
                ],
                columnStyles: {
                    0: { cellWidth: 55, halign: 'left', fontStyle: 'bold', fillColor: [240, 240, 240] },
                    1: { cellWidth: 100, halign: 'left', fontStyle: 'normal', fillColor: [255, 255, 255] },
                    2: { cellWidth: 48, halign: 'left', fontStyle: 'bold', fillColor: [240, 240, 240] },
                    3: { cellWidth: '25%', halign: 'left', fontStyle: 'normal', fillColor: [255, 255, 255] }
                },
                theme: 'plain',
                styles: { 
                    fontSize: 10, 
                    cellPadding: 2, 
                    lineWidth: 0.1,
                    fillColor: [240, 240, 240]
                },
                didDrawPage: function(data) {
                    data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                    adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                }
            });
            startY = doc.autoTable.previous.finalY + 5;

            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text('PLANO DE AULA', 145, 40, null, null, 'center');
            doc.setFontSize(10);
            doc.text(`VIGÊNCIA: ${formatarData(vigenciaDe)} ATÉ ${formatarData(vigenciaAte)}`, 145, 50, null, null, 'center');

            startY = doc.autoTable.previous.finalY + 10;

            if (doc.internal.getCurrentPageInfo().pageNumber > 1) {
                startY = Math.max(startY, margemSuperiorOutras);
            }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('1. DESCRITORES', 15, startY);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);

            if (objetosConhecimento && objetosConhecimento.trim()) {
                const objetosArray = objetosConhecimento.split('\n').map(item => item.trim()).filter(item => item);
                if (objetosArray.length > 0) {
                    try {
                        doc.autoTable({
                            startY: startY + 5,
                            margin: { top: margemSuperiorPrimeira, bottom: margemInferior },
                            head: [['OBJETOS DO CONHECIMENTO']],
                            body: objetosArray.map(objeto => ['• ' + objeto]),
                            columnStyles: {
                                0: { cellWidth: 269, halign: 'left' }
                            },
                            theme: 'plain',
                            headStyles: { 
                                fillColor: [240, 240, 240],
                                fontSize: 10,
                                fontStyle: 'bold'
                            },
                            bodyStyles: { 
                                fillColor: [255, 255, 255]
                            },
                            styles: { 
                                fontSize: 10, 
                                cellPadding: 2, 
                                lineWidth: 0.1
                            },
                            didDrawPage: function(data) {
                                data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                                adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                            }
                        });
                        startY = doc.autoTable.previous.finalY + 10;
                    } catch (error) {
                        console.error('Erro ao gerar tabela Objetos:', error);
                        startY += 5;
                    }
                }
            }

            if (doc.internal.getCurrentPageInfo().pageNumber > 1) {
                startY = Math.max(startY, margemSuperiorOutras);
            }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('2. CAMINHO METODOLÓGICO', 15, startY);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);

            try {
                doc.autoTable({
                    startY: startY + 5,
                    margin: { top: margemSuperiorOutras, bottom: margemInferior },
                    head: [['AULA', 'DESCRIÇÃO']],
                    body: aulaData,
                    columnStyles: {
                        0: { cellWidth: 30, halign: 'left', fontStyle: 'normal' },
                        1: { cellWidth: 239, halign: 'left', fontStyle: 'normal' }
                    },
                    theme: 'plain',
                    headStyles: { 
                        fillColor: [240, 240, 240],
                        fontSize: 10,
                        fontStyle: 'bold'
                    },
                    bodyStyles: { 
                        fillColor: [255, 255, 255]
                    },
                    styles: { 
                        fontSize: 10, 
                        cellPadding: 2, 
                        lineWidth: 0.1
                    },
                    didDrawPage: function(data) {
                        data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                        adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                    }
                });
                startY = doc.autoTable.previous.finalY + 10;
            } catch (error) {
                console.error('Erro ao gerar tabela Aulas:', error);
                startY += 20;
            }

            if (doc.internal.getCurrentPageInfo().pageNumber > 1) {
                startY = Math.max(startY, margemSuperiorOutras);
            }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('3. AVALIAÇÃO', 15, startY);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            try {
                doc.autoTable({
                    startY: startY + 5,
                    margin: { top: margemSuperiorOutras, bottom: margemInferior },
                    head: [['CRITÉRIOS DE AVALIAÇÃO']],
                    body: criteriosAvaliacao.length > 0 ? criteriosAvaliacao.map(criterio => [criterio]) : [['Sem critérios definidos']],
                    columnStyles: {
                        0: { cellWidth: 269, halign: 'left' }
                    },
                    theme: 'plain',
                    headStyles: { 
                        fillColor: [240, 240, 240],
                        fontSize: 10,
                        fontStyle: 'bold'
                    },
                    bodyStyles: { 
                        fillColor: [255, 255, 255]
                    },
                    styles: { 
                        fontSize: 10, 
                        cellPadding: 2, 
                        lineWidth: 0.1
                    },
                    didDrawPage: function(data) {
                        data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                        adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                    }
                });
                startY = doc.autoTable.previous.finalY + 0;
            } catch (error) {
                console.error('Erro ao gerar tabela Critérios:', error);
                startY += 5;
            }

            try {
                doc.autoTable({
                    startY: startY + 5,
                    margin: { top: margemSuperiorOutras, bottom: margemInferior },
                    head: [['INSTRUMENTOS DE AVALIAÇÃO']],
                    body: instrumentosAvaliacao.length > 0 ? instrumentosAvaliacao.map(instrumento => [instrumento]) : [['Sem instrumentos definidos']],
                    columnStyles: {
                        0: { cellWidth: 269, halign: 'left' }
                    },
                    theme: 'plain',
                    headStyles: { 
                        fillColor: [240, 240, 240],
                        fontSize: 10,
                        fontStyle: 'bold'
                    },
                    bodyStyles: { 
                        fillColor: [255, 255, 255]
                    },
                    styles: { 
                        fontSize: 10, 
                        cellPadding: 2, 
                        lineWidth: 0.1
                    },
                    didDrawPage: function(data) {
                        data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                        adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                    }
                });
                startY = doc.autoTable.previous.finalY + 10;
            } catch (error) {
                console.error('Erro ao gerar tabela Instrumentos:', error);
                startY += 20;
            }

            if (doc.internal.getCurrentPageInfo().pageNumber > 1) {
                startY = Math.max(startY, margemSuperiorOutras);
            }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(12);
            doc.text('4. REFERÊNCIAS BIBLIOGRÁFICAS', 15, startY);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(10);
            const referenciasLines = referenciasBibliograficas.split('\n').map(line => line.trim()).filter(line => line);
            if (referenciasLines.length > 0) {
                try {
                    doc.autoTable({
                        startY: startY + 5,
                        margin: { top: margemSuperiorOutras, bottom: margemInferior },
                        body: referenciasLines.map(line => [line]),
                        columnStyles: {
                            0: { cellWidth: 265, halign: 'left' }
                        },
                        theme: 'plain',
                        bodyStyles: { 
                            fillColor: [255, 255, 255],
                            lineWidth: 0
                        },
                        styles: { 
                            fontSize: 8,
                            cellPadding: 2, 
                            lineWidth: 0.1
                        },
                        didDrawPage: function(data) {
                            data.settings.margin.top = data.pageCount > 1 ? margemSuperiorOutras : margemSuperiorPrimeira;
                            adicionarCabecalho(doc, vigenciaDe, vigenciaAte, data.pageCount === 1);
                        }
                    });
                    startY = doc.autoTable.previous.finalY + 10;
                } catch (error) {
                    console.error('Erro ao gerar tabela de Referências:', error);
                    startY += 10;
                }
            }

            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.setFont('helvetica', 'normal');
                doc.text(`Página ${i} de ${pageCount}`, 266, 200);
            }

            doc.save(fileName);
        });
    } else {
        console.error('Botão Gerar PDF (gerarPDF) não encontrado!');
    }

    // Adicionar listeners para botões
    const salvarPlanoBtn = document.getElementById('salvarPlano');
    if (salvarPlanoBtn) {
        salvarPlanoBtn.addEventListener('click', window.salvarPlano);
    } else {
        console.error('Botão Salvar Plano (salvarPlano) não encontrado!');
    }

    // Inicializar com um campo para cada seção
    window.adicionarSelect();
    window.adicionarCriterioSelect();
    window.adicionarInstrumentoSelect();
    window.adicionarAulaField();
    loadOptions();
    loadPlanosSalvos();

    // Adicionar redimensionamento automático aos textareas
    const textareas = document.getElementsByClassName('auto-resize');
    for (let textarea of textareas) {
        autoResizeTextarea(textarea);
        textarea.addEventListener('input', function() {
            autoResizeTextarea(this);
        });
    }
});

// Função de logout
window.logout = function() {
    localStorage.removeItem('loggedIn');
    localStorage.removeItem('currentUser');
    window.location.href = 'login.html';
};